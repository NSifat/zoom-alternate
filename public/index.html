<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WebRTC Video Conference</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><rect fill='%230066cc' width='100' height='100'/><circle fill='white' cx='35' cy='40' r='15'/><circle fill='white' cx='65' cy='40' r='15'/><path fill='white' d='M 30 60 Q 50 75 70 60' stroke='white' stroke-width='3' fill='none'/></svg>">
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <!-- Join Room Modal -->
    <div id="joinModal" class="modal active">
        <div class="modal-content">
            <div class="modal-header">
                <h1><i class="fas fa-video"></i> Video Conference</h1>
                <p>Join or create a meeting</p>
            </div>
            <form id="joinForm" class="modal-form">
                <div class="form-group">
                    <label for="userName">Your Name</label>
                    <input 
                        type="text" 
                        id="userName" 
                        placeholder="Enter your name" 
                        required
                        autocomplete="off"
                    />
                </div>
                <div class="form-group">
                    <label for="roomId">Meeting Code (Optional)</label>
                    <input 
                        type="text" 
                        id="roomId" 
                        placeholder="Leave empty to auto-generate" 
                        autocomplete="off"
                    />
                    <small>Share this code with others to join the same meeting</small>
                </div>
                <button type="submit" class="btn btn-primary btn-large">
                    <i class="fas fa-arrow-right"></i> Join Meeting
                </button>
            </form>
            <div class="modal-footer">
                <p>ðŸ”’ All meetings are private and end when the last person leaves</p>
            </div>
        </div>
    </div>

    <!-- Main Conference Container -->
    <div id="conferenceContainer" class="conference-container hidden">
        <!-- Header -->
        <header class="conference-header">
            <div class="header-left">
                <h2><i class="fas fa-video"></i> Conference</h2>
                <span id="roomBadge" class="room-badge"></span>
            </div>
            <div class="header-right">
                <button id="shareCodeBtn" class="btn btn-sm" title="Copy meeting code to clipboard">
                    <i class="fas fa-share-alt"></i> Share Code
                </button>
                <button id="breakoutRoomsBtn" class="btn btn-sm" title="Manage breakout rooms">
                    <i class="fas fa-door-open"></i> Rooms
                </button>
            </div>
        </header>

        <!-- Video Grid -->
        <div class="video-grid-container">
            <div id="videoGrid" class="video-grid"></div>
            
            <!-- Share Screen Overlay -->
            <div id="screenShareOverlay" class="screen-share-overlay hidden">
                <div class="screen-share-content">
                    <video id="remoteScreenVideo" autoplay playsinline></video>
                    <div class="screen-share-controls">
                        <button id="pinScreenBtn" title="Pin screen">
                            <i class="fas fa-thumbtack"></i> Pin
                        </button>
                        <button id="fullscreenScreenBtn" title="Fullscreen">
                            <i class="fas fa-expand"></i> Fullscreen
                        </button>
                    </div>
                    <div class="screen-share-label">
                        <span id="screenShareUserName">Screen Share</span>
                    </div>
                </div>
                <div class="screen-share-thumbnails" id="screenShareThumbnails"></div>
            </div>
        </div>

        <!-- Chat Sidebar -->
        <aside id="chatSidebar" class="chat-sidebar">
            <div class="chat-header">
                <h3>Chat</h3>
                <button id="closeChatBtn" class="btn btn-sm">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div id="chatMessages" class="chat-messages"></div>
            <form id="chatForm" class="chat-form">
                <input 
                    type="text" 
                    id="chatInput" 
                    placeholder="Type a message..." 
                    autocomplete="off"
                />
                <button type="submit" class="btn btn-sm">
                    <i class="fas fa-paper-plane"></i>
                </button>
            </form>
        </aside>

        <!-- Breakout Rooms Modal -->
        <div id="breakoutModal" class="modal hidden">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Breakout Rooms</h3>
                    <button id="closeBreakoutBtn" class="btn btn-sm">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="breakout-controls">
                    <label for="breakoutCount">Number of breakout rooms</label>
                    <div class="breakout-controls-row">
                        <input 
                            type="number" 
                            id="breakoutCount" 
                            min="1"
                            max="50"
                            value="5"
                        />
                        <button id="createRoomBtn" class="btn btn-sm btn-primary">
                            <i class="fas fa-plus"></i> Create Rooms
                        </button>
                    </div>
                    <small>Rooms will be named Room 1, Room 2, ... You can doubleâ€‘click to rename.</small>
                </div>
                <div id="breakoutRoomsList" class="breakout-rooms-list"></div>
                <div class="modal-footer">
                    <button id="returnMainBtn" class="btn btn-sm">
                        <i class="fas fa-arrow-left"></i> Return to Main Meeting
                    </button>
                </div>
            </div>
        </div>

        <!-- Bottom Controls Bar -->
        <footer class="controls-bar">
            <div class="controls-group">
                <!-- Microphone Control -->
                <button id="toggleAudioBtn" class="control-btn" title="Toggle microphone">
                    <i class="fas fa-microphone"></i>
                    <span class="control-label">Mute</span>
                </button>

                <!-- Camera Control -->
                <button id="toggleVideoBtn" class="control-btn" title="Toggle camera">
                    <i class="fas fa-video"></i>
                    <span class="control-label">Camera</span>
                </button>

                <!-- Screen Share Control -->
                <button id="toggleScreenShareBtn" class="control-btn" title="Share your screen">
                    <i class="fas fa-share-square"></i>
                    <span class="control-label">Share</span>
                </button>

                <!-- Chat Control -->
                <button id="toggleChatBtn" class="control-btn" title="Open chat">
                    <i class="fas fa-comments"></i>
                    <span class="control-label">Chat</span>
                </button>

                <!-- Host Control (Host Only) -->
                <button id="hostPanelBtn" class="control-btn" title="Host controls">
                    <i class="fas fa-user-shield"></i>
                    <span class="control-label">Host</span>
                </button>

                <!-- Settings Control -->
                <button id="settingsBtn" class="control-btn" title="Settings">
                    <i class="fas fa-cog"></i>
                    <span class="control-label">Settings</span>
                </button>

                <!-- Hang Up Button -->
                <button id="hangUpBtn" class="control-btn hangup" title="Leave meeting">
                    <i class="fas fa-phone-slash"></i>
                    <span class="control-label">Leave</span>
                </button>

                <!-- Logout Button -->
                <button id="logoutBtn" class="control-btn" title="Logout" onclick="logout()">
                    <i class="fas fa-sign-out-alt"></i>
                    <span class="control-label">Logout</span>
                </button>
            </div>
        </footer>

        <!-- Settings Modal -->
        <div id="settingsModal" class="modal hidden">
            <div class="modal-content settings-modal">
                <div class="modal-header">
                    <h3><i class="fas fa-cog"></i> Meeting Settings</h3>
                    <button id="closeSettingsBtn" class="btn btn-sm">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                
                <div class="settings-sections">
                    <!-- General Settings -->
                    <div class="settings-section">
                        <h4>General Settings</h4>
                        <label class="settings-checkbox">
                            <input type="checkbox" id="joinMuted">
                            <span>New participants join muted</span>
                        </label>
                        <label class="settings-checkbox">
                            <input type="checkbox" id="showBreakout" checked>
                            <span>Show breakout rooms to participants</span>
                        </label>
                        <label class="settings-checkbox">
                            <input type="checkbox" id="enableChat" checked>
                            <span>Enable chat</span>
                        </label>
                    </div>
                    
                    <!-- Host Controls -->
                    <div class="settings-section">
                        <h4>Host Controls</h4>
                        <button onclick="muteAllParticipants()" class="btn btn-sm btn-warning">
                            <i class="fas fa-microphone-slash"></i> Mute All
                        </button>
                        <button onclick="disableAllCameras()" class="btn btn-sm btn-warning">
                            <i class="fas fa-video-slash"></i> Disable All Cameras
                        </button>
                        <button onclick="closeAllBreakoutRooms()" class="btn btn-sm btn-warning">
                            <i class="fas fa-door-closed"></i> Close All Breakout Rooms
                        </button>
                    </div>
                    
                    <!-- Participants List -->
                    <div class="settings-section">
                        <h4>Participants</h4>
                        <div id="participantsList" class="participants-list"></div>
                    </div>
                </div>
                
                <div class="modal-footer">
                    <button onclick="closeSettings()" class="btn btn-sm">Cancel</button>
                    <button onclick="saveSettings()" class="btn btn-sm btn-primary">Save Settings</button>
                </div>
            </div>
        </div>

        <!-- Toast Notifications -->
        <div id="toastContainer" class="toast-container"></div>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.socket.io/4.5.4/socket.io.min.js"></script>
    <script src="app.js"></script>
</body>
</html>

